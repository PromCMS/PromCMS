<?xml version="1.0" encoding="UTF-8"?>
<database name="bookstore" defaultIdMethod="native" namespace="PromCMS\Modules\<%- projectNameAsFolderName %>\Models">
  <% Object.entries({ ...config.database.models, ...config.database.singletons }).forEach(([modelName, model]) => { %>
    <table <%- objectToXmlAttributes(getModelToPropelTableAttributes(modelName, model)) %>>
      <% for (const [columnName, column] of model.columns) { %>
        <% if (column.type === "slug") { %>
          <behavior name="sluggable" />
        <% } else { %>
            <column <%- objectToXmlAttributes(getColumnToPropelAttributes(columnName, column)) %> />
            <% if (column.type === "relationship") { %>
              <foreign-key foreignTable="<%- column.targetModel %>">
                <reference local="<%- columnName %>" foreign="<%- column.foreignKey %>"/>
              </foreign-key>
            <% } %>
        <% } %> 
        
        <% const uniqueColumnNames = getUniqueColumnNames(model) %>
        <% if (uniqueColumnNames.length) { %>
          <unique name="/UniqueSet<%- projectNameAsFolderName %>/">
            <% for( const uniqueColumnName of uniqueColumnNames) { %>
              <unique-column name="/<%- uniqueColumnName %>/" />
            <% } %>
          </unique>
        <% } %>

        <% const localizedColumnNames = getLocalizedColumnNames(model) %>
        <% if (localizedColumnNames.length) { %>
          <behavior name="i18n">
            <parameter name="i18n_columns" value="<%- localizedColumnNames.join(', ') %>" />
          </behavior>
        <% } %>
      <% } %>

      <behavior name="prom_model" />
    </table>
  <% }) %>
</database>