<?php

use Illuminate\Database\Eloquent\Model;
<% if (softDelete) { %>
  use Illuminate\Database\Eloquent\SoftDeletes;
<% } %>

class <%- modelName %> extends Model
{
  <% if (softDelete) { %>
    use SoftDeletes;
  <% } %>

  protected $table = '<%- tableName %>';
  protected $modelIcon = '<%- icon %>';
  protected $hasTimestamps = <%- timestamp ? 'true' : 'false' %>;
  protected $hasSoftDeletes = <%- softDelete ? 'true' : 'false' %>;

  protected $tableColumns = [
    <% 
      Object.keys(columns).forEach(columnKey => { 
      const column = columns[columnKey];
    %>
       '<%- columnKey %>' => [
          'type' => '<%- column.type %>',
          'title' => '<%- column.title %>',
          'editable' => '<%- column.editable %>',
          <% if (column.type == 'enum') { %>
          'enum' => ['<%- column.enum.join("', '") %>'],
          <% } else if (column.type == 'number') { %>
          'autoIncrement' => <%- column.autoIncrement ? 'true' : 'false' %>,
          <% } %>
          'required' => <%- column.required ? 'true' : 'false'  %>,
          'hide' => <%- column.hide ? 'true' : 'false'  %>,
          'unique' => <%- column.unique ? 'true' : 'false'  %>,
        ],
    <% }) %>
  ];

  <%
    const fillableKeys =
      Object.keys(columns)
        .filter((columnKey) => !columns[columnKey].hide)
        .join("', '");
  %>
  protected $fillable = [
    '<%- fillableKeys %>'
  ];

  <%
    const hiddenKeys =
      Object.keys(columns)
        .filter((columnKey) => columns[columnKey].hide)
        .join("', '");
  %>
  <% if (hiddenKeys.length) { %>
  protected $hidden = [
    '<%- hiddenKeys %>'
  ];
  <% } %>

  public function getSummary () {
      return (object)[
        "columns" => $this->tableColumns,
        "tableName" => $this->table,
        "icon" => $this->modelIcon,
        "hasTimestamps" => $this->hasTimestamps,
        "hasSoftDelete" => $this->hasSoftDeletes
      ];
  }
}