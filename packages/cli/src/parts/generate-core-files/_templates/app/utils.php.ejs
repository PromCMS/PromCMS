<?php
/**
 * DO NOT DELETE OR EDIT THIS FILE.
 * THIS FILE IS PART OF COCKPIT CMS
 * AND ANY MODIFICATION MAY BREAK OR BE
 * OVERRIDDEN IN NEXT UPDATE.
 *
 */

class BootstrapUtils
{
  public static function getModuleRoot(string $moduleName)
  {
    return __DIR__ . "/../modules/$moduleName";
  }

  public static function getValidModuleNames()
  {
    return array_merge(
      ['Core'],
      // Filter out the 'Core' module from basic set
      array_filter(
        // Map that dirs to folder names
        array_map(
          function ($dir) {
            return basename($dir);
          },
          // Firstly get all the dirs from modules folder
          glob(__DIR__ . '/../modules/*', GLOB_ONLYDIR),
        ),
        function ($moduleName) {
          $moduleRoot = BootstrapUtils::getModuleRoot($moduleName);

          if (!file_exists("$moduleRoot/module-info.json")) {
            echo "<b>Warning </b> - Created module '$moduleName' wont be functional if you don't provide module-info.json";
            return false;
          }

          return $moduleName !== 'Core';
        },
      ),
    );
  }
}

function str_includes($haystack, $needle)
{
  return strpos($haystack, $needle) !== false;
}
