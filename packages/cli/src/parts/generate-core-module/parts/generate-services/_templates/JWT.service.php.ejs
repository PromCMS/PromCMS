<?php

namespace App\Services;

use DateTime;
use Firebase\JWT\JWT as JWTWorker;
use Firebase\JWT\Key;

class JWT 
{
  public function generate($payload, $expiration = PROM_TOKEN_LIFETIME)
  {
    $now = time();

    return JWTWorker::encode(array_merge(
      [
        'iat' => $now,
        'exp' => $now + $expiration
      ],
      $payload
    ), $_ENV['SECURITY_SECRET'], 'HS256');
  }

  public function validate(string $jwt)
  {
    return JWTWorker::decode($jwt, new Key($_ENV['SECURITY_SECRET'], 'HS256'));
  }
}